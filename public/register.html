<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Usuarios</title>
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <link rel="stylesheet" href="./style/estilosformularios.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;700;800&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<style>
            .info-box {
        background-color: transparent;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .payment-icons i {
        font-size: 24px;
        color: white;
        margin-right: 10px;
    }


     .password-container {
        position: relative;
        display: flex;
        align-items: center;
        max-width: 70%;
    margin-left: 20px;
    }

    .password-container input {
        width: 100%;
        padding-right: 30px; /* Espacio para el icono del ojo */
    }

    .password-container i {
        position: absolute;
        right: 10px;
        cursor: pointer;
        color: #B2987E; /* Marrón claro */
        top: 11px;

    }
    .option-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 20px;
    }

    .option {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 150px;
        height: 150px;
        border: 2px solid transparent;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: background-color 0.3s, border-color 0.3s;
    }

    .option i {
        font-size: 50px;
        color: white;
    }

    .option p {
        color: white;
        font-weight: bold;
        margin-top: 10px;
    }

    .option:hover {
        background-color: #f0f0f0;
    }

    .option.selected {
        border-color: #7F5B41;
        background-color: #B2987E;
    }
</style>

<body>
    <div id="menu"></div>
    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>
    
    <div class="my-container-bg">
        <div class="form-section-bg" id="registerForm1">
            <h2 style="margin: 50px 10px 30px 10px; color:white;">Registro de Usuario</h2>
            <form id="registerForm1Form">
                <input type="text" id="nombre" name="nombre" placeholder=" Nombre Completo"  required><br>
                <span id="nombreError" class="error"></span><br>
            
                <input type="email" id="email" name="email" placeholder="Correo electrónico"  required><br>
                <span id="emailError" class="error"></span><br>
            
                <input type="tel" id="telefono" name="telefono" placeholder=" Teléfono" required><br>
                <span id="telefonoError" class="error"></span><br>

                <div class="password-container">
                    <input type="password" id="password" name="password" placeholder=" Contraseña" required>
                    <i class="fas fa-eye" id="togglePassword" onclick="togglePasswordVisibility('password', 'togglePassword')"></i>
                </div>
                <span id="passwordError" class="error"></span><br>

                <div class="password-container">
                    <input type="password" id="confirm_password" name="confirm_password" placeholder=" Confirmar Contraseña" required>
                    <i class="fas fa-eye" id="toggleConfirmPassword" onclick="togglePasswordVisibility('confirm_password', 'toggleConfirmPassword')"></i>
                </div>
                <span id="confirmPasswordError" class="error"></span><br>

                <label for="fecha_nacimiento" style="color: white; max-width: 100%;">Fecha de Nacimiento:</label>
                <input type="text" id="fecha_nacimiento" name="fecha_nacimiento" required><br>
                <span id="fechaNacimientoError" class="error"></span><br>

                <div class="option-container">
                    <div class="option" id="option-hombre" onclick="selectGender('hombre')">
                        <i class="fas fa-male"></i>
                        <p>Hombre</p>
                    </div>
                    <div class="option selected" id="option-mujer" onclick="selectGender('mujer')">
                        <i class="fas fa-female"></i>
                        <p>Mujer</p>
                    </div>
                    <div class="option" id="option-otro" onclick="selectGender('otro')">
                        <i class="fas fa-genderless"></i>
                        <p>Prefiero no decir</p>
                    </div>
                </div>
                <input type="hidden" id="genero" name="genero" value="mujer">
                <span id="generoError" class="error"></span><br>

                <button type="button" class="button" onclick="submitForm()">Completar</button>
            </form>
        </div>
   
        <div class="form-section-bg" id="registerForm2" style="display: none;">
            <h2>Sube tu Foto de Perfil</h2>
            <form id="registerForm2Form" enctype="multipart/form-data">
                <input type="hidden" id="userId2" name="userId">
                <label for="foto_perfil">Comparte una foto desde tu carrete o tomate una foto para tu perfil pilßatero</label>
                <input type="file" id="foto_perfil" name="foto_perfil" required><br><br>
                <span id="fotoPerfilError" class="error"></span><br>
                
                <button type="button" class="button" onclick="submitForm2()">Continuar</button>
            </form>
        </div>
        <div class="form-section-bg" id="registerForm3" style="display: none;">
            <h2>Cuestionario y Datos Relevantes</h2>
            <label>Completa las siguientes preguntas que nos ayudaran con informacion necesaria para comenzar con nuestras clases de pilates</label><br>
        
            <form id="registerForm3Form">
                <input type="hidden" id="userId3" name="userId">
                <label for="pregunta1">¿Has practicado Pilates antes?</label><br>
                <select id="pregunta1" name="pregunta1" required>
                    <option value="">Seleccione</option>
                    <option value="si">Sí</option>
                    <option value="no">No</option>
                </select><br><br>
        
                <label for="pregunta2">¿Tienes alguna lesión o condición médica que debamos conocer?</label><br>
                <select id="pregunta2" name="pregunta2" onchange="toggleLesiones()" required>
                    <option value="">Seleccione</option>
                    <option value="si">Sí</option>
                    <option value="no">No</option>
                </select><br><br>
        
                <div id="lesionesSection" style="display:none;">
                    <span>Si tienes alguna condición médica o algo que debamos saber, por favor escríbelo aquí.</span>
                    <textarea id="lesiones" name="lesiones" rows="4" cols="50"></textarea><br><br>
                </div>
        
                <label for="pregunta3">¿Realizas ejercicio regularmente (al menos tres veces por semana)?</label><br>
                <select id="pregunta3" name="pregunta3" required>
                    <option value="">Seleccione</option>
                    <option value="si">Sí</option>
                    <option value="no">No</option>
                </select><br><br>
        
                <label for="pregunta4">¿Sigues algun plan de alimentación que debamos tener en cuenta para tu entrenamiento?</label><br>
                <select id="pregunta4" name="pregunta4" required>
                    <option value="">Seleccione</option>
                    <option value="si">Sí</option>
                    <option value="no">No</option>
                </select><br><br>
        
                <span>Cuéntanos un poco más sobre ti y por qué quieres practicar Pilates.</span>
                <textarea id="motivacion" name="motivacion" rows="4" cols="50"></textarea><br><br>
                
                <span id="cuestionarioError" class="error"></span><br>
                        
                <button type="button" class="button" onclick="submitForm3()">Continuar</button>
            </form>
        </div>
        

        <div class="form-section-bg" id="registerForm5" style="display: none;">
            <h2>Como quieres Pilatear</h2>
            <form id="registerForm5Form">
                <input type="hidden" id="userId5" name="userId">
                <input type="hidden" id="modalidad" name="modalidad" value="presencial">
                
                <div class="option-container">
                    <div class="option" id="option-online" onclick="selectOption('online')">
                        <i class="fas fa-laptop"></i>
                        <p>ONLINE</p>
                    </div>
                    <div class="option selected" id="option-presencial" onclick="selectOption('presencial')">
                        <i class="fas fa-home"></i>
                        <p>PRESENCIAL</p>
                    </div>
                </div>
                
                <span id="modalidadError" class="error"></span><br>
                <button type="button" class="button" onclick="submitForm5()">Continuar</button>
            </form>
        </div>
        <div class="form-section-bg" id="registerForm6" style="display: none;">
            <h2>Selección de Paquete</h2>
            <div class="option-container">
                <div class="option" id="option-Paquete básico" onclick="selectPackage('Paquete básico')">
                    <p>1 vez por semana</p>
                </div>
                <div class="option" id="option-Paquete completo" onclick="selectPackage('Paquete completo')">
                    <p>2 veces por semana</p>
                </div>
                <div class="option" id="option-Paquete premium" onclick="selectPackage('Paquete premium')">
                    <p>3 veces por semana</p>
                </div>
            </div>
            <input type="hidden" id="paquete" name="paquete" value="Paquete completo">
            
            
            
            <div id="packageDescription" class="info-box">
                <h3>Descripción del Paquete</h3>
                <ul id="packageDetails">
                    <!-- Detalles del paquete se mostrarán aquí -->
                </ul>
                <p id="packageCost"></p>
            </div>
            
            <div class="info-box">
                <p style="color: black;">Información de cuenta:</p>
                <ul>
                    <li>N• 2204332302 ahorro</li>
                    <li>1757209158</li>
                    <li>Ariadna Labarca</li>
                    <li>Pichincha</li>
                    <li>ariadna2400@gmail.com</li>
                </ul>
                <div class="payment-icons">
                    <i class="fas fa-credit-card"></i>
                    <i class="fas fa-money-bill-wave"></i>
                    <i class="fas fa-wallet"></i>
                </div>
                <p>Aceptamos todo tipo de pago.</p>
            </div>
        
            <form id="registerForm6Form" enctype="multipart/form-data">
                <input type="hidden" id="userId6" name="userId">
                <label for="comprobante_pago" style="color: black;">Compártenos una foto o screenshot de tu pago</label>
                <input type="file" id="comprobante_pago" name="comprobante_pago" required><br><br>
                <span id="comprobantePagoError" class="error"></span><br>
                
                <input type="checkbox" id="showBilling" onclick="toggleBillingForm()"> Agregar datos de facturación<br><br>
        
                <div id="billingForm" style="display: none;">
                    <h2>Datos de Facturación</h2>
                    <input type="hidden" id="usuario_id_billing" name="usuario_id">
                    <label for="cedula_ruc">Cédula o RUC:</label>
                    <input type="text" id="cedula_ruc" name="cedula_ruc" placeholder="Cedula o Ruc"><br><br>
                    
                    <label for="direccion1">Dirección 1:</label>
                    <input type="text" id="direccion1" name="direccion1" placeholder="Direccion"><br><br>
                    
                    <label for="direccion2">Dirección 2:</label>
                    <input type="text" id="direccion2" name="direccion2" placeholder="Dirección 2"><br><br>
                    
                    <label for="telefono_billing">Teléfono:</label>
                    <input type="text" id="telefono_billing" name="telefono" placeholder="Teléfono"><br><br>
                    
                    <label for="nombre_completo">Nombre Completo:</label>
                    <input type="text" id="nombre_completo" name="nombre_completo" placeholder="Nombre completo"><br><br>
                    
                    <label for="razon_social">Razón Social:</label>
                    <input type="text" id="razon_social" name="razon_social" placeholder="Razón Social"><br><br>
                    
                    <label for="otro_dato">Otro Dato:</label>
                    <input type="text" id="otro_dato" name="otro_dato" placeholder="extra"><br><br>
                </div>
        
                <button type="button" class="button" onclick="submitForm6()">Verificar Pago</button>
            </form>
        </div>
        

        <div id="successMessage" style="display: none; color: green;">
            <h2>Te has registrado con éxito</h2>
            <p>Serás redirigido al inicio de sesión en 5 segundos...</p>
        </div>

    </div>
        
    <div id="footer"></div>
    <div id="sidebar-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>

function togglePasswordVisibility(inputId, toggleId) {
        const passwordInput = document.getElementById(inputId);
        const toggleIcon = document.getElementById(toggleId);
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleIcon.classList.remove('fa-eye');
            toggleIcon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            toggleIcon.classList.remove('fa-eye-slash');
            toggleIcon.classList.add('fa-eye');
        }
    }

flatpickr("#fecha_nacimiento", {
            dateFormat: "Y-m-d",
            allowInput: false
        });

        function selectGender(genero) {
            document.getElementById('genero').value = genero;

            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));

            const selectedOption = document.getElementById(`option-${genero}`);
            selectedOption.classList.add('selected');
        }

function toggleLesiones() {
        const pregunta2 = document.getElementById('pregunta2').value;
        const lesionesSection = document.getElementById('lesionesSection');
        
        if (pregunta2 === 'si') {
            lesionesSection.style.display = 'block';
        } else {
            lesionesSection.style.display = 'none';
        }
    }


function scrollToTop() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}

function updateProgressBar(step) {
    const totalSteps = 6; // Actualiza este número si tienes más o menos pasos
    const percentage = (step / totalSteps) * 100;
    const progressBar = document.getElementById('progress-bar');
    progressBar.style.width = percentage + '%';
    progressBar.textContent = Math.round(percentage) + '%';
}

        

function submitForm() {
    const nombre = document.getElementById('nombre').value;
    const email = document.getElementById('email').value;
    const telefono = document.getElementById('telefono').value;
    const password = document.getElementById('password').value;
    const confirm_password = document.getElementById('confirm_password').value;
    const fecha_nacimiento = document.getElementById('fecha_nacimiento').value;
    const genero = document.getElementById('genero').value;

    if (nombre.length < 3) {
        document.getElementById('nombreError').textContent = 'El nombre debe tener al menos 3 caracteres.';
        return;
    }

    const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
    if (!emailPattern.test(email)) {
        document.getElementById('emailError').textContent = 'Por favor, ingrese un email válido.';
        return;
    }

    if (telefono.length < 8) {
        document.getElementById('telefonoError').textContent = 'Por favor, ingrese un teléfono válido.';
        return;
    }

    if (password.length < 6) {
        document.getElementById('passwordError').textContent = 'La contraseña debe tener al menos 6 caracteres.';
        return;
    }

    if (password !== confirm_password) {
        document.getElementById('confirmPasswordError').textContent = 'Las contraseñas no coinciden.';
        return;
    }

    if (!fecha_nacimiento) {
        document.getElementById('fechaNacimientoError').textContent = 'Por favor, ingrese una fecha de nacimiento.';
        return;
    }

    if (!genero) {
        document.getElementById('generoError').textContent = 'Por favor, seleccione un género.';
        return;
    }

    fetch('/register/step1', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ nombre, email, telefono, password, fecha_nacimiento, genero })
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(err => { throw new Error(err.message); });
        }
        return response.json();
    })
    .then(data => {
        if (data.message !== 'Datos principales guardados exitosamente') {
            document.getElementById('nombreError').textContent = data.message;
        } else {
            // Avanzar al siguiente paso
            document.getElementById('registerForm1').style.display = 'none';
            document.getElementById('registerForm2').style.display = 'block';
            document.getElementById('userId2').value = data.userId; // Asignar el userId al segundo formulario

            // Actualizar barra de progreso
            updateProgressBar(2); // Cambiar a 2 para el segundo paso
            scrollToTop()
        }
    })
    .catch(error => {
        console.error('Error durante el registro:', error);
        document.getElementById('nombreError').textContent = 'Error durante el registro';
    });
}

       
function submitForm2() {
    const form = document.getElementById('registerForm2Form');
    const formData = new FormData(form);

    fetch('/register/step2', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(err => { throw new Error(err.message); });
        }
        return response.json();
    })
    .then(data => {
        if (data.message !== 'Foto de perfil actualizada exitosamente') {
            document.getElementById('fotoPerfilError').textContent = data.message;
        } else {
            // Avanzar al siguiente paso
            document.getElementById('registerForm2').style.display = 'none';
            document.getElementById('registerForm3').style.display = 'block';
            document.getElementById('userId3').value = document.getElementById('userId2').value; // Asignar el userId al tercer formulario

            // Actualizar barra de progreso
            updateProgressBar(3); // Cambiar a 3 para el tercer paso
        }
    })
    .catch(error => {
        console.error('Error durante la subida de la foto de perfil:', error);
        document.getElementById('fotoPerfilError').textContent = 'Error durante la subida de la foto de perfil';
    });
}
function submitForm3() {
        const userId = document.getElementById('userId3').value;
        const pregunta1 = document.getElementById('pregunta1').value;
        const pregunta2 = document.getElementById('pregunta2').value;
        const pregunta3 = document.getElementById('pregunta3').value;
        const pregunta4 = document.getElementById('pregunta4').value;
        const lesiones = document.getElementById('lesiones').value;
        const motivacion = document.getElementById('motivacion').value;

        if (!pregunta1 || !pregunta2 || !pregunta3 || !pregunta4) {
            // Asegúrate de que todas las preguntas sean respondidas
            return;
        }

        fetch('/register/step3', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ userId, pregunta1, pregunta2, pregunta3, pregunta4, lesiones, motivacion })
        })
        .then(response => {
            if (!response.ok) {
                return response.json().then(err => { throw new Error(err.message); });
            }
            return response.json();
        })
        .then(data => {
            if (data.message !== 'Cuestionario y datos relevantes guardados exitosamente') {
                document.getElementById('cuestionarioError').textContent = data.message;
            } else {
                // Avanzar al siguiente paso
                document.getElementById('registerForm3').style.display = 'none';
                document.getElementById('registerForm5').style.display = 'block';
                document.getElementById('userId5').value = document.getElementById('userId3').value; // Asignar el userId al quinto formulario

                // Actualizar barra de progreso
                updateProgressBar(5); // Cambiar a 5 para el quinto paso
                scrollToTop();
            }
        })
        .catch(error => {
            console.error('Error durante el cuestionario:', error);
            document.getElementById('cuestionarioError').textContent = 'Error durante el cuestionario';
        });
    }

    function selectOption(modalidad) {
        document.getElementById('modalidad').value = modalidad;
        
        const options = document.querySelectorAll('.option');
        options.forEach(option => option.classList.remove('selected'));

        const selectedOption = document.getElementById(`option-${modalidad}`);
        selectedOption.classList.add('selected');
    }

    function submitForm5() {
        const modalidad = document.getElementById('modalidad').value;
        const userId = document.getElementById('userId5').value;

        if (!modalidad) {
            document.getElementById('modalidadError').textContent = 'Por favor, seleccione una modalidad.';
            return;
        }

        fetch('/register/step5', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ userId, modalidad })
        })
        .then(response => {
            if (!response.ok) {
                return response.json().then(err => { throw new Error(err.message); });
            }
            return response.json();
        })
        .then(data => {
            if (data.message !== 'Modalidad guardada exitosamente') {
                document.getElementById('modalidadError').textContent = data.message;
            } else {
                document.getElementById('registerForm5').style.display = 'none';
                document.getElementById('registerForm6').style.display = 'block';
                document.getElementById('userId6').value = document.getElementById('userId5').value;

                // Actualizar barra de progreso
                updateProgressBar(6); // Cambiar a 6 para el sexto paso
                scrollToTop();
            }
        })
        .catch(error => {
            console.error('Error durante la selección de modalidad:', error);
            document.getElementById('modalidadError').textContent = 'Error durante la selección de modalidad';
        });
    }

    


    function toggleBillingForm() {
        const billingForm = document.getElementById('billingForm');
        if (document.getElementById('showBilling').checked) {
            billingForm.style.display = 'block';
        } else {
            billingForm.style.display = 'none';
        }
    }

    // Inicializar con el paquete "completo" preseleccionado
    document.addEventListener("DOMContentLoaded", function() {
        selectPackage('completo');
    });


    function selectPackage(paquete) {
    const paqueteInput = document.getElementById('paquete');
    const selectedOption = document.getElementById(`option-${paquete}`);

    // Verificar si los elementos existen
    if (!paqueteInput) {
        console.error('No se encontró el input hidden para el paquete.');
        return;
    }

    if (!selectedOption) {
        console.error(`No se encontró el elemento para el paquete: ${paquete}`);
        return;
    }

    paqueteInput.value = paquete;

    const options = document.querySelectorAll('.option');
    options.forEach(option => option.classList.remove('selected'));

    selectedOption.classList.add('selected');

    const packageDetails = document.getElementById('packageDetails');
    const packageCost = document.getElementById('packageCost');

    switch(paquete) {
        case 'Paquete básico':
            packageDetails.innerHTML = `
                <li>4 clases por mes</li>
                <li>Duración de un mes</li>
                <li>Acceso a contenido exclusivo online</li>
            `;
            packageCost.textContent = "Costo: $30";
            break;
        case 'Paquete completo':
            packageDetails.innerHTML = `
                <li>8 clases por mes</li>
                <li>Duración de un mes</li>
                <li>Acceso a contenido exclusivo online</li>
                <li>Soporte personalizado</li>
            `;
            packageCost.textContent = "Costo: $50";
            break;
        case 'Paquete premium':
            packageDetails.innerHTML = `
                <li>12 clases por mes</li>
                <li>Duración de un mes</li>
                <li>Acceso a contenido exclusivo online</li>
                <li>Soporte personalizado</li>
                <li>Sesiones adicionales de coaching</li>
            `;
            packageCost.textContent = "Costo: $70";
            break;
        default:
            packageDetails.innerHTML = '';
            packageCost.textContent = '';
    }
}
function submitForm6() {
    const form = document.getElementById('registerForm6Form');
    const formData = new FormData(form);
    const showBilling = document.getElementById('showBilling').checked;

    const paquete = document.getElementById('paquete').value;
    formData.append('paquete', paquete);

    if (showBilling) {
        const cedula_ruc = document.getElementById('cedula_ruc').value;
        const direccion1 = document.getElementById('direccion1').value;
        const direccion2 = document.getElementById('direccion2').value;
        const telefono = document.getElementById('telefono_billing').value;
        const nombre_completo = document.getElementById('nombre_completo').value;
        const razon_social = document.getElementById('razon_social').value;
        const otro_dato = document.getElementById('otro_dato').value;

        formData.append('cedula_ruc', cedula_ruc);
        formData.append('direccion1', direccion1);
        formData.append('direccion2', direccion2);
        formData.append('telefono', telefono);
        formData.append('nombre_completo', nombre_completo);
        formData.append('razon_social', razon_social);
        formData.append('otro_dato', otro_dato);
    }

    fetch('/register/step6', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(err => { 
                console.log('Error del servidor:', err);
                throw new Error(err.message); 
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.message !== 'Verificación de pago exitosa') {
            document.getElementById('comprobantePagoError').textContent = data.message;
        } else {
            document.getElementById('registerForm6').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';

            setTimeout(() => {
                window.location.href = '/login';
            }, 5000);
        }
    })
    .catch(error => {
        console.error('Error durante la verificación del pago:', error);
        document.getElementById('comprobantePagoError').textContent = 'Error durante la verificación del pago';
    });
}

function sendConfirmationEmail(userId) {
    fetch('/send-confirmation-email', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userId })
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(err => { 
                console.log('Error al enviar el correo de confirmación:', err);
                throw new Error(err.message); 
            });
        }
        return response.json();
    })
    .then(data => {
        console.log('Correo de confirmación enviado:', data.message);
    })
    .catch(error => {
        console.error('Error al enviar el correo de confirmación:', error);
    });
}





        function loadComponent(id, url, callback) {
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    document.getElementById(id).innerHTML = data;
                    if (callback) callback();
                })
                .catch(error => console.error('Error loading component:', error));
        }

        document.addEventListener("DOMContentLoaded", function() {
            loadComponent('menu', 'menu.html', initializeMenu);
            loadComponent('footer', 'footer.html');
            loadComponent('sidebar-container', 'sidebar.html');

            function initializeMenu() {
                const toggleButton = document.getElementById('navbar-toggle');
                const closeButton = document.getElementById('close-button');
                const fullscreenMenu = document.getElementById('fullscreen-menu');

                if (toggleButton && closeButton && fullscreenMenu) {
                    toggleButton.addEventListener('click', () => {
                        fullscreenMenu.classList.add('open');
                    });

                    closeButton.addEventListener('click', () => {
                        fullscreenMenu.classList.remove('open');
                    });
                }
            }
        });
    </script>
    <script src="./js/sidebar.js"></script>
</body>
</html>
